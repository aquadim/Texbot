# Техбот
[Техбот](https://vk.com/vpmt_bot) - это чат-бот, работающий с социальной сетью ВКонтакте. Главная задача бота - помогать студентам [ВПМТ](http://www.vpmt.ru/)

## Благодарности
[Виталий Романов](https://vk.com/id240088163) - Со-основатель и ещё иногда моральная поддержка

[Матвей Чайников](https://vk.com/id357719032) - Предложил функцию "Оценки"

## Подготовка среды работы
Техбот работает корректно, если
* установлен на unix-подобной системе (протестирован с Ubuntu 20.04)
* установлен php как минимум версии 7.4 (это самая старая протестированная версия)
* установлен веб-сервер (протестирован с apache)
* установлена СУБД (протестирован с MariaDB)
* установлен composer

## Установка
1. Клонируйте этот репозиторий с помощью ```git clone https://github.com/aquadim/Texbot```
2. Создайте .env файл в корневой директории бота. Заполнение файла см. ниже
3. Убедитесь что установлены следующие расширения php:
   * gd
   * curl
   * mysqli
4. Зайдите в систему управления БД и импортируйте схему базы данных с помощью файла ```texbot.sql```
5. Создайте сообщество ВКонтакте, в котором будет оперировать бот.
6. Заполните настройки Callback Api для сообщества (Настройки -> Работа с API -> Callback API)
   * На вкладке "Настройки сервера" укажите адрес и версию API (5.131)
   * Скопируйте строку которую должен вернуть сервер
   * В .env файл вставьте следующее: ```confirmation_token="строка подтверждения"```
   * Нажмите ```Подтвердить```. После этого вы сможете получать запросы от ВКонтакте
   * На вкладке "Типы событий" убедитесь, что **только следующие пункты отмечены: Входящее сообщение, Действие с сообщением**
7. Заполните файл .env

## Заполнение .env файла
```
vk_token="<ключ доступа к API>"
public_id=<ID группы в которой оперирует Техбот>
notifications_type="<telegram или email>" # Каким способом уведомлять об ошибках - через telegram или через email?
webmaster_email="<email адрес на который присылаются уведомления об ошибках>" # Имеет эффект только если notifications_type - email
notifier_email="<email адрес отправителя уведомлений>" # Например: texbot@vpmt.ru.
notifier_bot_token="<токен телеграм бота для уведомлений>" # Имеет эффект только если notifications_type - telegram
notifier_bot_chat=<Чат в который отсылаются уведомления по телеграмму> # Имеет эффект только если notifications_type - telegram

db_server="<адрес сервера БД, обычно localhost>"
db_user="<имя пользователя БД>"
db_password="<пароль пользователя БД>"
db_name="<название БД>"
```

## Примечания
Для уведомлений об ошибках через email необходимо установить программу sendmail
